
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ca: Low-level Channel Access module &#8212; Epics Channel Access for Python</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/epicsdoc.css?v=29cb9c05" />
    <script src="_static/documentation_options.js?v=993fb437"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Working with waveform / array data" href="arrays.html" />
    <link rel="prev" title="PV: Epics Process Variables" href="pv.html" /> 
  </head><body>
<div style="background-color: #E7F0F3; text-align: left; padding: 8px 4px 8px 4px">
  <font size=+3><a href="index.html">
      <img src="_static/pyepics.png" height=50 border="0" alt="pyepics"/>
    &nbsp; PyEpics: Epics Channel Access for Python</a>
  </font>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="arrays.html" title="Working with waveform / array data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pv.html" title="PV: Epics Process Variables"
             accesskey="P">previous</a> |</li>
   <li>[<a href="installation.html">install</a></li>
   <li>|<a href="overview.html">overview</a></li>
   <li>|<a href="pv.html">pv</a></li>
   <li>|<a href="#">ca</a></li>
   <li>|<a href="arrays.html">arrays</a></li>
   <li>|<a href="devices.html">devices</a></li>
   <li>|<a href="alarm.html">alarm</a></li>
   <li>|<a href="autosave.html">autosave</a></li>
   <li>|<a href="wx.html">wx</a></li>
   <li>|<a href="advanced.html">advanced</a>]</li>

        <li class="nav-item nav-item-this"><a href="">ca: Low-level Channel Access module</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">ca: Low-level Channel Access module</a><ul>
<li><a class="reference internal" href="#general-description-difference-with-c-library">General description, difference with C library</a><ul>
<li><a class="reference internal" href="#name-mangling">Name Mangling</a></li>
<li><a class="reference internal" href="#other-changes-and-omissions">Other Changes and Omissions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#initialization-finalization-and-life-cycle">Initialization, Finalization, and Life-cycle</a><ul>
<li><a class="reference internal" href="#epics.ca.PREEMPTIVE_CALLBACK"><code class="docutils literal notranslate"><span class="pre">PREEMPTIVE_CALLBACK</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.DEFAULT_CONNECTION_TIMEOUT"><code class="docutils literal notranslate"><span class="pre">DEFAULT_CONNECTION_TIMEOUT</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.AUTOMONITOR_MAXLENGTH"><code class="docutils literal notranslate"><span class="pre">AUTOMONITOR_MAXLENGTH</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-ca-module">Using the CA module</a><ul>
<li><a class="reference internal" href="#epics.ca.initialize_libca"><code class="docutils literal notranslate"><span class="pre">initialize_libca()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.finalize_libca"><code class="docutils literal notranslate"><span class="pre">finalize_libca()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.pend_io"><code class="docutils literal notranslate"><span class="pre">pend_io()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.pend_event"><code class="docutils literal notranslate"><span class="pre">pend_event()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.poll"><code class="docutils literal notranslate"><span class="pre">poll()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.create_context"><code class="docutils literal notranslate"><span class="pre">create_context()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.destroy_context"><code class="docutils literal notranslate"><span class="pre">destroy_context()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.current_context"><code class="docutils literal notranslate"><span class="pre">current_context()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.attach_context"><code class="docutils literal notranslate"><span class="pre">attach_context()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.detach_context"><code class="docutils literal notranslate"><span class="pre">detach_context()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.use_initial_context"><code class="docutils literal notranslate"><span class="pre">use_initial_context()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.client_status"><code class="docutils literal notranslate"><span class="pre">client_status()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.version"><code class="docutils literal notranslate"><span class="pre">version()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.message"><code class="docutils literal notranslate"><span class="pre">message()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.flush_io"><code class="docutils literal notranslate"><span class="pre">flush_io()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.replace_printf_handler"><code class="docutils literal notranslate"><span class="pre">replace_printf_handler()</span></code></a></li>
<li><a class="reference internal" href="#creating-and-connecting-to-channels">Creating and Connecting to Channels</a><ul>
<li><a class="reference internal" href="#epics.ca.create_channel"><code class="docutils literal notranslate"><span class="pre">create_channel()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.connect_channel"><code class="docutils literal notranslate"><span class="pre">connect_channel()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.name"><code class="docutils literal notranslate"><span class="pre">name()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.host_name"><code class="docutils literal notranslate"><span class="pre">host_name()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.element_count"><code class="docutils literal notranslate"><span class="pre">element_count()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.replace_access_rights_event"><code class="docutils literal notranslate"><span class="pre">replace_access_rights_event()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.read_access"><code class="docutils literal notranslate"><span class="pre">read_access()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.write_access"><code class="docutils literal notranslate"><span class="pre">write_access()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.field_type"><code class="docutils literal notranslate"><span class="pre">field_type()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.clear_channel"><code class="docutils literal notranslate"><span class="pre">clear_channel()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.state"><code class="docutils literal notranslate"><span class="pre">state()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.isConnected"><code class="docutils literal notranslate"><span class="pre">isConnected()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.access"><code class="docutils literal notranslate"><span class="pre">access()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.promote_type"><code class="docutils literal notranslate"><span class="pre">promote_type()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca._cache"><code class="docutils literal notranslate"><span class="pre">_cache</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.show_cache"><code class="docutils literal notranslate"><span class="pre">show_cache()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.clear_cache"><code class="docutils literal notranslate"><span class="pre">clear_cache()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#interacting-with-connected-channels">Interacting with Connected Channels</a><ul>
<li><a class="reference internal" href="#epics.ca.get"><code class="docutils literal notranslate"><span class="pre">get()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.get_with_metadata"><code class="docutils literal notranslate"><span class="pre">get_with_metadata()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.get_complete"><code class="docutils literal notranslate"><span class="pre">get_complete()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.get_complete_with_metadata"><code class="docutils literal notranslate"><span class="pre">get_complete_with_metadata()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.put"><code class="docutils literal notranslate"><span class="pre">put()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.create_subscription"><code class="docutils literal notranslate"><span class="pre">create_subscription()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.DEFAULT_SUBSCRIPTION_MASK"><code class="docutils literal notranslate"><span class="pre">DEFAULT_SUBSCRIPTION_MASK</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.clear_subscription"><code class="docutils literal notranslate"><span class="pre">clear_subscription()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.get_timestamp"><code class="docutils literal notranslate"><span class="pre">get_timestamp()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.get_severity"><code class="docutils literal notranslate"><span class="pre">get_severity()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.get_precision"><code class="docutils literal notranslate"><span class="pre">get_precision()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.get_enum_strings"><code class="docutils literal notranslate"><span class="pre">get_enum_strings()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.get_ctrlvars"><code class="docutils literal notranslate"><span class="pre">get_ctrlvars()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.get_timevars"><code class="docutils literal notranslate"><span class="pre">get_timevars()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#synchronous-groups">Synchronous Groups</a><ul>
<li><a class="reference internal" href="#epics.ca.sg_create"><code class="docutils literal notranslate"><span class="pre">sg_create()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.sg_delete"><code class="docutils literal notranslate"><span class="pre">sg_delete()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.sg_block"><code class="docutils literal notranslate"><span class="pre">sg_block()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.sg_get"><code class="docutils literal notranslate"><span class="pre">sg_get()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.sg_put"><code class="docutils literal notranslate"><span class="pre">sg_put()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.sg_test"><code class="docutils literal notranslate"><span class="pre">sg_test()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.sg_reset"><code class="docutils literal notranslate"><span class="pre">sg_reset()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-details">Implementation details</a><ul>
<li><a class="reference internal" href="#dbr-data-types">DBR data types</a></li>
<li><a class="reference internal" href="#pysevchk-and-channelaccessexcepction-checking-ca-return-codes"><cite>PySEVCHK</cite> and ChannelAccessExcepction: checking CA return codes</a><ul>
<li><a class="reference internal" href="#epics.ca.ChannelAccessException"><code class="docutils literal notranslate"><span class="pre">ChannelAccessException</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.PySEVCHK"><code class="docutils literal notranslate"><span class="pre">PySEVCHK()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.withSEVCHK"><code class="docutils literal notranslate"><span class="pre">withSEVCHK()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#function-decorators">Function Decorators</a><ul>
<li><a class="reference internal" href="#epics.ca.withCA"><code class="docutils literal notranslate"><span class="pre">withCA()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.withCHID"><code class="docutils literal notranslate"><span class="pre">withCHID()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.withConnectedCHID"><code class="docutils literal notranslate"><span class="pre">withConnectedCHID()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.withInitialContext"><code class="docutils literal notranslate"><span class="pre">withInitialContext()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#unpacking-data-from-callbacks">Unpacking Data from Callbacks</a><ul>
<li><a class="reference internal" href="#epics.ca._unpack"><code class="docutils literal notranslate"><span class="pre">_unpack()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#user-supplied-callback-functions">User-supplied Callback functions</a></li>
<li><a class="reference internal" href="#omissions">Omissions</a><ul>
<li><a class="reference internal" href="#epics.ca.ca_add_exception_event"><code class="docutils literal notranslate"><span class="pre">ca_add_exception_event()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.ca_add_fd_registration"><code class="docutils literal notranslate"><span class="pre">ca_add_fd_registration()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.ca_client_status"><code class="docutils literal notranslate"><span class="pre">ca_client_status()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.ca_set_puser"><code class="docutils literal notranslate"><span class="pre">ca_set_puser()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.ca_puser"><code class="docutils literal notranslate"><span class="pre">ca_puser()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.ca_SEVCHK"><code class="docutils literal notranslate"><span class="pre">ca_SEVCHK()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.ca_signal"><code class="docutils literal notranslate"><span class="pre">ca_signal()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.ca_test_event"><code class="docutils literal notranslate"><span class="pre">ca_test_event()</span></code></a></li>
<li><a class="reference internal" href="#epics.ca.ca_dump_dbr"><code class="docutils literal notranslate"><span class="pre">ca_dump_dbr()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#cathread-class"><code class="xref py py-class docutils literal notranslate"><span class="pre">CAThread</span></code> class</a><ul>
<li><a class="reference internal" href="#epics.ca.CAThread"><code class="docutils literal notranslate"><span class="pre">CAThread</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#create-connect-get-value-of-channel">Create, Connect, Get Value of Channel</a></li>
<li><a class="reference internal" href="#put-waiting-for-completion">Put, waiting for completion</a></li>
<li><a class="reference internal" href="#define-a-callback-to-subscribe-to-changes">Define a callback to Subscribe to Changes</a></li>
<li><a class="reference internal" href="#define-a-connection-callback">Define a connection callback</a></li>
<li><a class="reference internal" href="#define-an-access-rights-change-event-callback">Define an access rights change event callback</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="pv.html"
                          title="previous chapter">PV: Epics Process Variables</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="arrays.html"
                          title="next chapter">Working with waveform / array data</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ca.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-epics.ca">
<span id="ca-low-level-channel-access-module"></span><h1>ca: Low-level Channel Access module<a class="headerlink" href="#module-epics.ca" title="Link to this heading">¶</a></h1>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">ca</span></code> module provides a low-level wrapping of the EPICS Channel Access
(CA) library, using ctypes.  Most users of the <cite>epics</cite> module will not need to
be concerned with most of the details here, and will instead use the simple
procedural interface (<a class="reference internal" href="overview.html#epics.caget" title="epics.caget"><code class="xref py py-func docutils literal notranslate"><span class="pre">epics.caget()</span></code></a>, <a class="reference internal" href="overview.html#epics.caput" title="epics.caput"><code class="xref py py-func docutils literal notranslate"><span class="pre">epics.caput()</span></code></a> and so on), or
use the <code class="xref py py-class docutils literal notranslate"><span class="pre">epics.PV</span></code> class to create and use epics PV objects.</p>
<section id="general-description-difference-with-c-library">
<h2>General description, difference with C library<a class="headerlink" href="#general-description-difference-with-c-library" title="Link to this heading">¶</a></h2>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">ca</span></code> module provides a fairly complete mapping of the C interface to
the CA library while also providing a pleasant Python experience.  It is
expected that anyone using this module is somewhat familiar with Channel
Access and knows where to consult the <a class="reference external" href="https://epics.anl.gov/base/R3-14/8-docs/CAref.html">Channel Access Reference Documentation</a>. Here, we focus on the
differences with the C interface, and assume a general understanding of what
the functions are meant to do.</p>
<section id="name-mangling">
<h3>Name Mangling<a class="headerlink" href="#name-mangling" title="Link to this heading">¶</a></h3>
<p>As a general rule, a CA function named <cite>ca_XXX</cite> in the C library will have the
equivalent function called <cite>XXX</cite> in the <cite>ca</cite> module.  This is because the
intention is that one will import the <cite>ca</cite> module with</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">epics</span> <span class="kn">import</span> <span class="n">ca</span>
</pre></div>
</div>
<p>so that the Python function <code class="xref py py-func docutils literal notranslate"><span class="pre">ca.XXX()</span></code> will corresponds to the C
function <cite>ca_XXX</cite>.  That is, the CA library called its functions <cite>ca_XXX</cite>
because C does not have namespaces.  Python does have namespaces, and so
they are used.</p>
<p>Similar name <em>un-mangling</em> also happens with the DBR prefixes for
constants, held here in the <cite>dbr</cite> module.  Thus, the C constant DBR_STRING
becomes dbr.STRING in Python.</p>
</section>
<section id="other-changes-and-omissions">
<h3>Other Changes and Omissions<a class="headerlink" href="#other-changes-and-omissions" title="Link to this heading">¶</a></h3>
<p>Several function in the C version of the CA library are not implemented in
the Python module.  Most of these unimplemented functions are currently
seen as unnecessary for Python, though some of these could be added without
much trouble if needed. See <a class="reference internal" href="#ca-omissions-label"><span class="std std-ref">Omissions</span></a> for further details.</p>
<p>In addition, while the CA library supports several <cite>DBR</cite> types in C, not
all of these are supported in Python. Only native types and their DBR_TIME
and DBR_CTRL variants are supported here.  The DBR_STS and DBR_GR variants
are not, as they are subsets of the DBR_CTRL type, and space optimization
is not something you’ll be striving for with Python.  Several <cite>dbr_XXX</cite>
functions are also not supported, as they appear to be needed only to be
able to dynamically allocate memory, which is not necessary in Python.</p>
</section>
</section>
<section id="initialization-finalization-and-life-cycle">
<span id="ca-init-label"></span><h2>Initialization, Finalization, and Life-cycle<a class="headerlink" href="#initialization-finalization-and-life-cycle" title="Link to this heading">¶</a></h2>
<p>The Channel Access library must be initialized before it can be used.
There are 3 main reasons for this need:</p>
<blockquote>
<div><p>1. CA requires a context model (preemptive callbacks or  non-preemptive
callbacks) to be specified before any actual calls can be made.</p>
<p>2. the ctypes interface requires that the shared library be loaded
before it is used.</p>
<p>3. ctypes also requires that references to the library and callback
functions be kept for the life-cycle of CA-using part of a program (or
else they will be garbage collected).</p>
</div></blockquote>
<p>As far as is possible, the <code class="xref py py-mod docutils literal notranslate"><span class="pre">ca</span></code> module hides the details of the CA
lifecyle from the user, so that it is not necessary to to worry about
explicitly initializing a Channel Access session.  Instead, the library is
initialized as soon as it is needed, and intervention is really only
required to change default settings.  The <code class="xref py py-mod docutils literal notranslate"><span class="pre">ca</span></code> module also handles
finalizing the CA session, so that core-dumps and warning messages do not
happen due to CA still being ‘alive’ as a program ends.</p>
<p>Because some users may wish to customize the initialization and
finalization process, the detailed steps will be described here.  These
initialization and finalization tasks are handled in the following way:</p>
<blockquote>
<div><ul class="simple">
<li><p>The <code class="xref py py-data docutils literal notranslate"><span class="pre">libca</span></code> variable in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">ca</span></code> module holds a permanent,
global reference to the CA shared object library (DLL).</p></li>
<li><p>the function <a class="reference internal" href="#epics.ca.initialize_libca" title="epics.ca.initialize_libca"><code class="xref py py-func docutils literal notranslate"><span class="pre">initialize_libca()</span></code></a> is called to initialize libca.
This function takes no arguments, but does use the global Boolean
<a class="reference internal" href="#epics.ca.PREEMPTIVE_CALLBACK" title="epics.ca.PREEMPTIVE_CALLBACK"><code class="xref py py-data docutils literal notranslate"><span class="pre">PREEMPTIVE_CALLBACK</span></code></a> (default value of <code class="docutils literal notranslate"><span class="pre">True</span></code>) to control
whether preemptive callbacks are used.</p></li>
<li><p>the function <a class="reference internal" href="#epics.ca.finalize_libca" title="epics.ca.finalize_libca"><code class="xref py py-func docutils literal notranslate"><span class="pre">finalize_libca()</span></code></a> is used to finalize libca.
Normally, this is function is registered to be called when a program
ends with <code class="xref py py-func docutils literal notranslate"><span class="pre">atexit.register()</span></code>.  Note that this only gets called on
a graceful shutdown. If the program crashes (for a non-CA related
reason, for example), this finalization may not be done, and
connections to Epics Variables may not be closed completely on the
Channel Access server.</p></li>
</ul>
</div></blockquote>
<dl class="py data">
<dt class="sig sig-object py" id="epics.ca.PREEMPTIVE_CALLBACK">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">PREEMPTIVE_CALLBACK</span></span><a class="headerlink" href="#epics.ca.PREEMPTIVE_CALLBACK" title="Link to this definition">¶</a></dt>
<dd><p>sets whether preemptive callbacks will be used.  The default value is
<code class="docutils literal notranslate"><span class="pre">True</span></code>.  If you wish to run without preemptive callbacks this variable
<em>MUST</em> be set before any other use of the CA library.  With preemptive
callbacks enabled, EPICS communication will not require client code to
continually poll for changes.   With preemptive callback disables,  you
will need to frequently poll epics with <a class="reference internal" href="#epics.ca.pend_io" title="epics.ca.pend_io"><code class="xref py py-func docutils literal notranslate"><span class="pre">pend_io()</span></code></a> and
func:<cite>pend_event</cite>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="epics.ca.DEFAULT_CONNECTION_TIMEOUT">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_CONNECTION_TIMEOUT</span></span><a class="headerlink" href="#epics.ca.DEFAULT_CONNECTION_TIMEOUT" title="Link to this definition">¶</a></dt>
<dd><p>sets the default <cite>timeout</cite> value (in seconds) for
<a class="reference internal" href="#epics.ca.connect_channel" title="epics.ca.connect_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect_channel()</span></code></a>.  The default value is <cite>2.0</cite></p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="epics.ca.AUTOMONITOR_MAXLENGTH">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">AUTOMONITOR_MAXLENGTH</span></span><a class="headerlink" href="#epics.ca.AUTOMONITOR_MAXLENGTH" title="Link to this definition">¶</a></dt>
<dd><p>sets the default array length (ie, how many elements an array has) above
which automatic conversion to numpy arrays <em>and</em> automatic monitoring
for PV variables is suppressed.  The default value is 65536.  To be
clear: waveforms with fewer elements than this value will be
automatically monitored changes, and will be converted to numpy arrays
(if numpy is installed).  Larger waveforms will not be automatically
monitored.</p>
<p><a class="reference internal" href="arrays.html#arrays-label"><span class="std std-ref">Working with waveform / array data</span></a> and <a class="reference internal" href="arrays.html#arrays-large-label"><span class="std std-ref">Strategies for working with large arrays</span></a> for more details.</p>
</dd></dl>

</section>
<section id="using-the-ca-module">
<h2>Using the CA module<a class="headerlink" href="#using-the-ca-module" title="Link to this heading">¶</a></h2>
<p>Many general-purpose CA functions that deal with general communication and
threading contexts are very close to the C library:</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.initialize_libca">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">initialize_libca</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.initialize_libca" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the Channel Access library.</p>
<blockquote>
<div><p>This loads the shared object library (DLL) to establish Channel Access
Connection. The value of <a class="reference internal" href="#epics.ca.PREEMPTIVE_CALLBACK" title="epics.ca.PREEMPTIVE_CALLBACK"><code class="xref py py-data docutils literal notranslate"><span class="pre">PREEMPTIVE_CALLBACK</span></code></a> sets the pre-emptive
callback model.</p>
</div></blockquote>
<dl class="simple">
<dt>This <strong>must</strong> be called prior to any actual use of the CA library, but</dt><dd><p>will be called automatically by the the <a class="reference internal" href="#epics.ca.withCA" title="epics.ca.withCA"><code class="xref py py-func docutils literal notranslate"><span class="pre">withCA()</span></code></a> decorator, so
you should not need to call this directly from most real programs.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>libca</strong><span class="classifier">object</span></dt><dd><p>ca library object, used for all subsequent ca calls</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function must be called prior to any real CA calls.</p>
<p>See the <cite>withCA</cite>  decorator to ensure CA is initialized</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.finalize_libca">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">finalize_libca</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.finalize_libca" title="Link to this definition">¶</a></dt>
<dd><p>shutdown channel access:</p>
<p>run <a class="reference internal" href="#epics.ca.clear_channel" title="epics.ca.clear_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">clear_channel()</span></code></a> for all chids in <a class="reference internal" href="#epics.ca._cache" title="epics.ca._cache"><code class="xref py py-data docutils literal notranslate"><span class="pre">_cache</span></code></a>,
then calls <a class="reference internal" href="#epics.ca.flush_io" title="epics.ca.flush_io"><code class="xref py py-func docutils literal notranslate"><span class="pre">flush_io()</span></code></a> and <a class="reference internal" href="#epics.ca.poll" title="epics.ca.poll"><code class="xref py py-func docutils literal notranslate"><span class="pre">poll()</span></code></a> a few times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>maxtime</strong><span class="classifier">float</span></dt><dd><p>maximimum time (in seconds) to wait for <a class="reference internal" href="#epics.ca.flush_io" title="epics.ca.flush_io"><code class="xref py py-func docutils literal notranslate"><span class="pre">flush_io()</span></code></a> and <a class="reference internal" href="#epics.ca.poll" title="epics.ca.poll"><code class="xref py py-func docutils literal notranslate"><span class="pre">poll()</span></code></a> to complete.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.pend_io">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">pend_io</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.pend_io" title="Link to this definition">¶</a></dt>
<dd><p>polls CA for i/o.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.pend_event">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">pend_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.e-5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.pend_event" title="Link to this definition">¶</a></dt>
<dd><p>polls CA for events</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.poll">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">poll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evt=1.e-5</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">iot=1.0</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.poll" title="Link to this definition">¶</a></dt>
<dd><p>a convenience function which is equivalent to::
pend_event(evt)
pend_io_(iot)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.create_context">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">create_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.create_context" title="Link to this definition">¶</a></dt>
<dd><p>Create a new context, using the value of <a class="reference internal" href="#epics.ca.PREEMPTIVE_CALLBACK" title="epics.ca.PREEMPTIVE_CALLBACK"><code class="xref py py-data docutils literal notranslate"><span class="pre">PREEMPTIVE_CALLBACK</span></code></a>
to set the context type. Note that both <em>context_create</em> and
<em>create_context</em> (which is more consistent with the Verb_Object of
the rest of the CA library) are supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ctx</strong><span class="classifier">int</span></dt><dd><p>0 – No preemptive callbacks,
1 – use use preemptive callbacks,
None – use value of <a class="reference internal" href="#epics.ca.PREEMPTIVE_CALLBACK" title="epics.ca.PREEMPTIVE_CALLBACK"><code class="xref py py-data docutils literal notranslate"><span class="pre">PREEMPTIVE_CALLBACK</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.destroy_context">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">destroy_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.destroy_context" title="Link to this definition">¶</a></dt>
<dd><p>destroy current context</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.current_context">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">current_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.current_context" title="Link to this definition">¶</a></dt>
<dd><p>return the current context</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.attach_context">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">attach_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.attach_context" title="Link to this definition">¶</a></dt>
<dd><p>attach to the supplied context</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.detach_context">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">detach_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.detach_context" title="Link to this definition">¶</a></dt>
<dd><p>detach context</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.use_initial_context">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">use_initial_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.use_initial_context" title="Link to this definition">¶</a></dt>
<dd><p>Attaches to the context created when libca is initialized.
Using this function is recommended when writing threaded programs that
using CA.</p>
<p>See the advanced section in doc for further discussion.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.client_status">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">client_status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.client_status" title="Link to this definition">¶</a></dt>
<dd><p>print (to stderr) information about Channel Access status,
including status for each channel, and search and connection statistics.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.version">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.version" title="Link to this definition">¶</a></dt>
<dd><p>Print Channel Access version string.
Currently, this should report ‘4.13’</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.message">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.message" title="Link to this definition">¶</a></dt>
<dd><p>Print a message corresponding to a Channel Access status return value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.flush_io">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">flush_io</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.flush_io" title="Link to this definition">¶</a></dt>
<dd><p>flush i/o</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.replace_printf_handler">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">replace_printf_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.replace_printf_handler" title="Link to this definition">¶</a></dt>
<dd><p>replace the normal printf() output handler
with the supplied function (defaults to <code class="xref py py-func docutils literal notranslate"><span class="pre">sys.stderr.write()</span></code>)</p>
</dd></dl>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><cite>replace_printf_handler()</cite> appears to not actually work.</p>
<p>We think this is due to a real limitation of Python’s <cite>ctypes</cite> module
not supporting the mapping of C <em>va_list</em> function arguments to Python.
If you are interested in this or have ideas of how to fix it, please
let us know.</p>
</div>
<section id="creating-and-connecting-to-channels">
<h3>Creating and Connecting to Channels<a class="headerlink" href="#creating-and-connecting-to-channels" title="Link to this heading">¶</a></h3>
<p>The basic channel object is the Channel ID or <code class="docutils literal notranslate"><span class="pre">chid</span></code>.  With the CA
library (and <code class="docutils literal notranslate"><span class="pre">ca</span></code> module), one creates and acts on the <code class="docutils literal notranslate"><span class="pre">chid</span></code> values.
These are simply <code class="xref py py-data docutils literal notranslate"><span class="pre">ctypes.c_long</span></code> (C long integers) that hold the
memory address of the C representation of the channel, but it is probably
a good idea to treat these as object instances.</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.create_channel">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">create_channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pvname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.create_channel" title="Link to this definition">¶</a></dt>
<dd><p>create a Channel for a given pvname</p>
<p>creates a channel, returning the Channel ID <code class="docutils literal notranslate"><span class="pre">chid</span></code> used by other
functions to identify this channel.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>pvname</strong><span class="classifier">string</span></dt><dd><p>the name of the PV for which a channel should be created.</p>
</dd>
<dt><strong>connect</strong><span class="classifier">bool</span></dt><dd><p>whether to (try to) connect to PV as soon as possible.</p>
</dd>
<dt><strong>auto_cb</strong><span class="classifier">bool</span></dt><dd><p>whether to automatically use an internal connection callback.</p>
</dd>
<dt><strong>callback</strong><span class="classifier">callable or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>user-defined Python function to be called when the connection
state change s.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>chid</strong><span class="classifier">ctypes.c_long</span></dt><dd><p>channel ID.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>1. The user-defined connection callback function should be prepared to accept
keyword arguments of</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>keyword</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>pvname</cite></p></td>
<td><p>name of PV</p></td>
</tr>
<tr class="row-odd"><td><p><cite>chid</cite></p></td>
<td><p>Channel ID</p></td>
</tr>
<tr class="row-even"><td><p><cite>conn</cite></p></td>
<td><p>whether channel is connected</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>2. If <cite>auto_cb</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, an internal connection callback is used so
that you should not need to explicitly connect to a channel, unless you
are having difficulty with dropped connections.</p>
<p>3. If the channel is already connected for the PV name, the callback
will be called immediately.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.connect_channel">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">connect_channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.connect_channel" title="Link to this definition">¶</a></dt>
<dd><p>connect to a channel, waiting up to timeout for a
channel to connect.  It returns the connection state,
<code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>This is usually not needed, as implicit connection will be done
when needed in most cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chid</strong><span class="classifier">ctypes.c_long</span></dt><dd><p>Channel ID</p>
</dd>
<dt><strong>timeout</strong><span class="classifier">float</span></dt><dd><p>maximum time to wait for connection.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool</span></dt><dd><p>whether to print out debugging information</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>connection_state</strong><span class="classifier">bool</span></dt><dd><p>that is, whether the Channel is connected</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>If <em>timeout</em> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the value of <a class="reference internal" href="#epics.ca.DEFAULT_CONNECTION_TIMEOUT" title="epics.ca.DEFAULT_CONNECTION_TIMEOUT"><code class="xref py py-data docutils literal notranslate"><span class="pre">DEFAULT_CONNECTION_TIMEOUT</span></code></a>
is used (defaults to 2.0 seconds).</p></li>
</ol>
<p>2. Normally, channels will connect in milliseconds, and the connection
callback will succeed on the first attempt.</p>
<p>3. For un-connected Channels (that are nevertheless queried), the ‘ts’
(timestamp of last connection attempt) and ‘failures’ (number of failed
connection attempts) from the <a class="reference internal" href="#epics.ca._cache" title="epics.ca._cache"><code class="xref py py-data docutils literal notranslate"><span class="pre">_cache</span></code></a> will be used to prevent
spending too much time waiting for a connection that may never happen.</p>
</dd></dl>

<p>Many other functions require a valid Channel ID, but not necessarily a
connected Channel.  These functions are essentially identical to the CA
library versions, and include:</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.name">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.name" title="Link to this definition">¶</a></dt>
<dd><p>return PV name for channel name</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.host_name">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">host_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.host_name" title="Link to this definition">¶</a></dt>
<dd><p>return host name and port serving Channel</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.element_count">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">element_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.element_count" title="Link to this definition">¶</a></dt>
<dd><p>return number of elements in Channel’s data.
1 for most Channels, &gt; 1 for waveform Channels</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.replace_access_rights_event">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">replace_access_rights_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.replace_access_rights_event" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.read_access">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">read_access</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.read_access" title="Link to this definition">¶</a></dt>
<dd><p>return <em>read access</em> for a Channel: 1 for <code class="docutils literal notranslate"><span class="pre">True</span></code>, 0 for <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.write_access">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">write_access</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.write_access" title="Link to this definition">¶</a></dt>
<dd><p>return <em>write access</em> for a channel: 1 for <code class="docutils literal notranslate"><span class="pre">True</span></code>, 0 for <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.field_type">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">field_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.field_type" title="Link to this definition">¶</a></dt>
<dd><p>return the integer DBR field type.</p>
</dd></dl>

<p>See the <em>ftype</em> column from <a class="reference internal" href="#dbrtype-table"><span class="std std-ref">Table of DBR Types</span></a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.clear_channel">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">clear_channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.clear_channel" title="Link to this definition">¶</a></dt>
<dd><p>clear the channel</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.state">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.state" title="Link to this definition">¶</a></dt>
<dd><p>return state (that is, attachment state) for channel</p>
</dd></dl>

<p>A few additional pythonic functions have been added:</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.isConnected">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">isConnected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.isConnected" title="Link to this definition">¶</a></dt>
<dd><p>return whether channel is connected:  <cite>dbr.CS_CONN==state(chid)</cite></p>
<p>This is <code class="docutils literal notranslate"><span class="pre">True</span></code> for a connected channel, <code class="docutils literal notranslate"><span class="pre">False</span></code> for an unconnected channel.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.access">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">access</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.access" title="Link to this definition">¶</a></dt>
<dd><p>returns a string describing read/write access: one of
<cite>no access</cite>, <cite>read-only</cite>, <cite>write-only</cite>, or <cite>read/write</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.promote_type">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">promote_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">use_time=False</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">use_ctrl=False</span></span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.promote_type" title="Link to this definition">¶</a></dt>
<dd><p>promotes the native field type of a <code class="docutils literal notranslate"><span class="pre">chid</span></code> to its TIME or CTRL variant.
Returns the integer corresponding to the promoted field value.</p>
</dd></dl>

<p>See <a class="reference internal" href="#dbrtype-table"><span class="std std-ref">Table of DBR Types</span></a>.</p>
<dl class="py data">
<dt class="sig sig-object py" id="epics.ca._cache">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">_cache</span></span><a class="headerlink" href="#epics.ca._cache" title="Link to this definition">¶</a></dt>
<dd><p>The ca module keeps a global cache of Channels that holds connection
status and a bit of internal information for all known PVs.  This cache
is not intended for general use.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.show_cache">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">show_cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.show_cache" title="Link to this definition">¶</a></dt>
<dd><p>print out a listing of PVs in the current session to
standard output.  Use the <em>print_out=False</em> option to be
returned the listing instead of having it printed out.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.clear_cache">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">clear_cache</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.clear_cache" title="Link to this definition">¶</a></dt>
<dd><p>Clears global caches of Epics CA connections, and fully
detaches from the CA context.  This is important when doing
multiprocessing (and is done internally by CAProcess),
but can be useful to fully reset a Channel Access session.</p>
<p>Any class <cite>PV</cite> created prior this call without using <cite>get_pv()</cite>
have to be disconnected (use <cite>PV.disconnect()</cite>) explicitly
because disconnection clears subscriptions to events of
Epics CA connection which are to be cleared here.
No instance of the class <cite>PV</cite> created prior this call should be
used after because underlaying Epics CA connections are cleared here.
Failing to follow these rules may cause your application to experience
a random SIGSEGV from inside Epics binaries.</p>
<p>Use <cite>register_clear_cache()</cite> to register a function which will be
called before Epics CA connections are cleared.</p>
<p>This function is not thread safe.</p>
</dd></dl>

</section>
<section id="interacting-with-connected-channels">
<h3>Interacting with Connected Channels<a class="headerlink" href="#interacting-with-connected-channels" title="Link to this heading">¶</a></h3>
<p>Once a <code class="docutils literal notranslate"><span class="pre">chid</span></code> is created and connected there are several ways to
communicating with it.  These are primarily encapsulated in the functions
<a class="reference internal" href="#epics.ca.get" title="epics.ca.get"><code class="xref py py-func docutils literal notranslate"><span class="pre">get()</span></code></a>, <a class="reference internal" href="#epics.ca.put" title="epics.ca.put"><code class="xref py py-func docutils literal notranslate"><span class="pre">put()</span></code></a>, and <a class="reference internal" href="#epics.ca.create_subscription" title="epics.ca.create_subscription"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_subscription()</span></code></a>, with a few
additional functions for retrieving specific information.</p>
<p>These functions are where this python module differs the most from the
underlying CA library, and this is mostly due to the underlying CA function
requiring the user to supply DBR TYPE and count as well as <code class="docutils literal notranslate"><span class="pre">chid</span></code> and
allocated space for the data.  In python none of these is needed, and
keyword arguments can be used to specify such options.</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.get">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_numpy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wait</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.get" title="Link to this definition">¶</a></dt>
<dd><p>return the current value for a Channel.
Note that there is not a separate form for array data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chid</strong><span class="classifier">ctypes.c_long</span></dt><dd><p>Channel ID</p>
</dd>
<dt><strong>ftype</strong><span class="classifier">int</span></dt><dd><p>field type to use (native type is default)</p>
</dd>
<dt><strong>count</strong><span class="classifier">int</span></dt><dd><p>maximum element count to return (full data returned by default)</p>
</dd>
<dt><strong>as_string</strong><span class="classifier">bool</span></dt><dd><p>whether to return the string representation of the value.
See notes below.</p>
</dd>
<dt><strong>as_numpy</strong><span class="classifier">bool</span></dt><dd><p>whether to return the Numerical Python representation
for array / waveform data.</p>
</dd>
<dt><strong>wait</strong><span class="classifier">bool</span></dt><dd><p>whether to wait for the data to be received, or return immediately.</p>
</dd>
<dt><strong>timeout</strong><span class="classifier">float</span></dt><dd><p>maximum time to wait for data before returning <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>data</strong><span class="classifier">object</span></dt><dd><p>Normally, the value of the data.  Will return <code class="docutils literal notranslate"><span class="pre">None</span></code> if the
channel is not connected, <cite>wait=False</cite> was used, or the data
transfer timed out.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>Returning <code class="docutils literal notranslate"><span class="pre">None</span></code> indicates an <em>incomplete get</em></p></li>
</ol>
<p>2. The <em>as_string</em> option is not as complete as the <em>as_string</em>
argument for <code class="xref py py-meth docutils literal notranslate"><span class="pre">PV.get()</span></code>.  For Enum types, the name of the Enum
state will be returned.  For waveforms of type CHAR, the string
representation will be returned.  For other waveforms (with <em>count</em> &gt;
1), a string like <cite>&lt;array count=3, type=1&gt;</cite> will be returned.</p>
<p>3. The <em>as_numpy</em> option will convert waveform data to be returned as a
numpy array.  This is only applied if numpy can be imported.</p>
<p>4. The <em>wait</em> option controls whether to wait for the data to be
received over the network and actually return the value, or to return
immediately after asking for it to be sent.  If <cite>wait=False</cite> (that is,
immediate return), the <em>get</em> operation is said to be <em>incomplete</em>.  The
data will be still be received (unless the channel is disconnected)
eventually but stored internally, and can be read later with
<a class="reference internal" href="#epics.ca.get_complete" title="epics.ca.get_complete"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_complete()</span></code></a>.  Using <cite>wait=False</cite> can be useful in some
circumstances.</p>
<p>5. The <em>timeout</em> option sets the maximum time to wait for the data to
be received over the network before returning <code class="docutils literal notranslate"><span class="pre">None</span></code>.  Such a timeout
could imply that the channel is disconnected or that the data size is
larger or network slower than normal.  In that case, the <em>get</em>
operation is said to be <em>incomplete</em>, and the data may become available
later with <a class="reference internal" href="#epics.ca.get_complete" title="epics.ca.get_complete"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_complete()</span></code></a>.</p>
</dd></dl>

<p>See <a class="reference internal" href="#dbrtype-table"><span class="std std-ref">Table of DBR Types</span></a> for a listing of values of <em>ftype</em>,</p>
<p>See <a class="reference internal" href="arrays.html#arrays-large-label"><span class="std std-ref">Strategies for working with large arrays</span></a> for a discussion of strategies  for how to best deal with very large arrays.</p>
<p>See <a class="reference internal" href="advanced.html#advanced-connecting-many-label"><span class="std std-ref">Strategies for connecting to a large number of PVs</span></a> for a discussion of when using <cite>wait=False</cite> can give a large performance boost.</p>
<p>See <a class="reference internal" href="advanced.html#advanced-get-timeouts-label"><span class="std std-ref">The wait and timeout options for get(), ca.get_complete()</span></a> for further discussion of the  <em>wait</em> and <em>timeout</em> options and the associated <a class="reference internal" href="#epics.ca.get_complete" title="epics.ca.get_complete"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_complete()</span></code></a>  function.</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.get_with_metadata">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">get_with_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_numpy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wait</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.get_with_metadata" title="Link to this definition">¶</a></dt>
<dd><p>Return the current value along with metadata for a Channel</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chid</strong><span class="classifier">ctypes.c_long</span></dt><dd><p>Channel ID</p>
</dd>
<dt><strong>ftype</strong><span class="classifier">int</span></dt><dd><p>field type to use (native type is default)</p>
</dd>
<dt><strong>count</strong><span class="classifier">int</span></dt><dd><p>maximum element count to return (full data returned by default)</p>
</dd>
<dt><strong>as_string</strong><span class="classifier">bool</span></dt><dd><p>whether to return the string representation of the value.  See notes.</p>
</dd>
<dt><strong>as_numpy</strong><span class="classifier">bool</span></dt><dd><p>whether to return the Numerical Python representation for array /
waveform data.</p>
</dd>
<dt><strong>wait</strong><span class="classifier">bool</span></dt><dd><p>whether to wait for the data to be received, or return immediately.</p>
</dd>
<dt><strong>timeout</strong><span class="classifier">float</span></dt><dd><p>maximum time to wait for data before returning <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>data</strong><span class="classifier">dict or None</span></dt><dd><p>The dictionary of data, guaranteed to at least have the ‘value’ key.
Depending on ftype, other keys may also be present:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;severity&#39;</span><span class="p">,</span> <span class="s1">&#39;enum_strs&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">,</span>
<span class="s1">&#39;severity&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;posixseconds&#39;</span><span class="p">,</span> <span class="s1">&#39;nanoseconds&#39;</span><span class="p">,</span>
<span class="s1">&#39;upper_disp_limit&#39;</span><span class="p">,</span> <span class="s1">&#39;lower_disp_limit&#39;</span><span class="p">,</span> <span class="s1">&#39;upper_alarm_limit&#39;</span><span class="p">,</span>
<span class="s1">&#39;upper_warning_limit&#39;</span><span class="p">,</span> <span class="s1">&#39;lower_warning_limit&#39;</span><span class="p">,</span><span class="s1">&#39;lower_alarm_limit&#39;</span><span class="p">,</span>
<span class="s1">&#39;upper_ctrl_limit&#39;</span><span class="p">,</span> <span class="s1">&#39;lower_ctrl_limit&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the channel is not connected, <cite>wait=False</cite> was used,
or the data transfer timed out.</p>
</dd>
<dt>See <cite>get()</cite> for additional usage notes.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.get_complete">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">get_complete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_numpy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.get_complete" title="Link to this definition">¶</a></dt>
<dd><p>returns the current value for a Channel, completing an
earlier incomplete <a class="reference internal" href="#epics.ca.get" title="epics.ca.get"><code class="xref py py-func docutils literal notranslate"><span class="pre">get()</span></code></a> that returned <code class="docutils literal notranslate"><span class="pre">None</span></code>, either
because <cite>wait=False</cite> was used or because the data transfer
did not complete before the timeout passed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chid</strong><span class="classifier">ctypes.c_long</span></dt><dd><p>Channel ID</p>
</dd>
<dt><strong>ftype</strong><span class="classifier">int</span></dt><dd><p>field type to use (native type is default)</p>
</dd>
<dt><strong>count</strong><span class="classifier">int</span></dt><dd><p>maximum element count to return (full data returned by default)</p>
</dd>
<dt><strong>as_string</strong><span class="classifier">bool</span></dt><dd><p>whether to return the string representation of the value.</p>
</dd>
<dt><strong>as_numpy</strong><span class="classifier">bool</span></dt><dd><p>whether to return the Numerical Python representation
for array / waveform data.</p>
</dd>
<dt><strong>timeout</strong><span class="classifier">float</span></dt><dd><p>maximum time to wait for data before returning <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>data</strong><span class="classifier">object</span></dt><dd><p>This function will return <code class="docutils literal notranslate"><span class="pre">None</span></code> if the previous <a class="reference internal" href="#epics.ca.get" title="epics.ca.get"><code class="xref py py-func docutils literal notranslate"><span class="pre">get()</span></code></a>
actually completed, or if this data transfer also times out.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>1. The default timeout is dependent on the element count::
default_timout = 1.0 + log10(count)  (in seconds)</p>
<ol class="arabic simple" start="2">
<li><p>Consult the doc for <a class="reference internal" href="#epics.ca.get" title="epics.ca.get"><code class="xref py py-func docutils literal notranslate"><span class="pre">get()</span></code></a> for more information.</p></li>
</ol>
</dd></dl>

<p>See <a class="reference internal" href="advanced.html#advanced-get-timeouts-label"><span class="std std-ref">The wait and timeout options for get(), ca.get_complete()</span></a> for further discussion.</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.get_complete_with_metadata">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">get_complete_with_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_numpy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.get_complete_with_metadata" title="Link to this definition">¶</a></dt>
<dd><p>Returns the current value and associated metadata for a Channel</p>
<p>This completes an earlier incomplete <a class="reference internal" href="#epics.ca.get" title="epics.ca.get"><code class="xref py py-func docutils literal notranslate"><span class="pre">get()</span></code></a> that returned <code class="docutils literal notranslate"><span class="pre">None</span></code>,
either because <cite>wait=False</cite> was used or because the data transfer did not
complete before the timeout passed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chid</strong><span class="classifier">ctypes.c_long</span></dt><dd><p>Channel ID</p>
</dd>
<dt><strong>ftype</strong><span class="classifier">int</span></dt><dd><p>field type to use (native type is default)</p>
</dd>
<dt><strong>count</strong><span class="classifier">int</span></dt><dd><p>maximum element count to return (full data returned by default)</p>
</dd>
<dt><strong>as_string</strong><span class="classifier">bool</span></dt><dd><p>whether to return the string representation of the value.</p>
</dd>
<dt><strong>as_numpy</strong><span class="classifier">bool</span></dt><dd><p>whether to return the Numerical Python representation
for array / waveform data.</p>
</dd>
<dt><strong>timeout</strong><span class="classifier">float</span></dt><dd><p>maximum time to wait for data before returning <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>data</strong><span class="classifier">dict or None</span></dt><dd><p>This function will return <code class="docutils literal notranslate"><span class="pre">None</span></code> if the previous <a class="reference internal" href="#epics.ca.get" title="epics.ca.get"><code class="xref py py-func docutils literal notranslate"><span class="pre">get()</span></code></a> actually
completed, or if this data transfer also times out.</p>
</dd>
<dt>See <cite>get_complete()</cite> for additional usage notes.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.put">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">put</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wait</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.put" title="Link to this definition">¶</a></dt>
<dd><p>sets the Channel to a value, with options to either wait
(block) for the processing to complete, or to execute a
supplied callback function when the process has completed.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>chid</strong><span class="classifier">ctypes.c_long</span></dt><dd><p>Channel ID</p>
</dd>
<dt><strong>wait</strong><span class="classifier">bool</span></dt><dd><p>whether to wait for processing to complete (or time-out)
before returning.</p>
</dd>
<dt><strong>timeout</strong><span class="classifier">float</span></dt><dd><p>maximum time to wait for processing to complete before returning anyway.</p>
</dd>
<dt><strong>callback</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">None</span></code> or callable</span></dt><dd><p>user-supplied function to run when processing has completed.</p>
</dd>
<dt><strong>callback_data</strong><span class="classifier">object</span></dt><dd><p>extra data to pass on to a user-supplied callback function.</p>
</dd>
<dt><strong>ftype</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">None</span></code> or int (valid dbr type)</span></dt><dd><p>force field type to be a non-native form (None will use native form)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>status</strong><span class="classifier">int</span></dt><dd><p>1  for success, -1 on time-out</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li><p>Specifying a callback will override setting <cite>wait=True</cite>.</p></li>
<li><dl class="simple">
<dt>A put-callback function will be called with keyword arguments</dt><dd><p>pvname=pvname, data=callback_data</p>
</dd>
</dl>
</li>
</ol>
</dd></dl>

<p>See <a class="reference internal" href="#ca-callbacks-label"><span class="std std-ref">User-supplied Callback functions</span></a> for more on this <em>put callback</em>,</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.create_subscription">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">create_subscription</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ctrl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.create_subscription" title="Link to this definition">¶</a></dt>
<dd><p>create a <em>subscription to changes</em>. Sets up a user-supplied
callback function to be called on any changes to the channel.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>chid</strong><span class="classifier">ctypes.c_long</span></dt><dd><p>channel ID</p>
</dd>
<dt><strong>use_time</strong><span class="classifier">bool</span></dt><dd><p>whether to use the TIME variant for the PV type</p>
</dd>
<dt><strong>use_ctrl</strong><span class="classifier">bool</span></dt><dd><p>whether to use the CTRL variant for the PV type</p>
</dd>
<dt><strong>ftype</strong><span class="classifier">integer or None</span></dt><dd><p>ftype to use, overriding native type, <cite>use_time</cite> or <cite>use_ctrl</cite>
if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the native type is looked up, which requires a
connected channel.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">integer or None</span></dt><dd><p>bitmask combination of <code class="xref py py-data docutils literal notranslate"><span class="pre">dbr.DBE_ALARM</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">dbr.DBE_LOG</span></code>, and
<code class="xref py py-data docutils literal notranslate"><span class="pre">dbr.DBE_VALUE</span></code>, to control which changes result in a callback.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <a class="reference internal" href="#epics.ca.DEFAULT_SUBSCRIPTION_MASK" title="epics.ca.DEFAULT_SUBSCRIPTION_MASK"><code class="xref py py-data docutils literal notranslate"><span class="pre">DEFAULT_SUBSCRIPTION_MASK</span></code></a>.</p>
</dd>
<dt><strong>callback</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">None</span></code> or callable</span></dt><dd><p>user-supplied callback function to be called on changes</p>
</dd>
<dt><strong>timeout</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">None</span></code> or int</span></dt><dd><p>connection timeout used for unconnected channels.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>(callback_ref, user_arg_ref, event_id)</dt><dd><p>The returned tuple contains <em>callback_ref</em> an <em>user_arg_ref</em> which
are references that should be kept for as long as the subscription
lives (otherwise they may be garbage collected, causing no end of
trouble).  <em>event_id</em> is the id for the event (useful for clearing
a subscription).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Keep the returned tuple in named variable!! if the return argument
gets garbage collected, a coredump will occur.</p>
<p>If the channel is not connected, the ftype must be specified for a
successful subscription.</p>
</dd></dl>

<p>See <a class="reference internal" href="#ca-callbacks-label"><span class="std std-ref">User-supplied Callback functions</span></a> for more on writing the user-supplied callback,</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><em>event_id</em> is the id for the event (useful for clearing a subscription).
You <strong>must</strong> keep the returned tuple in active variables, either as a
global variable or as data in an encompassing class.
If you do <em>not</em> keep this data, the return value will be garbage
collected, the C-level reference to the callback will disappear, and you
will see coredumps.</p>
<p>On Linux, a message like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span><span class="p">:</span> <span class="n">Objects</span><span class="o">/</span><span class="n">funcobject</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">451</span><span class="p">:</span> <span class="n">func_dealloc</span><span class="p">:</span> <span class="n">Assertion</span> <span class="s1">&#39;g-&gt;gc.gc_refs != (-2)&#39;</span> <span class="n">failed</span><span class="o">.</span>
<span class="n">Abort</span> <span class="p">(</span><span class="n">core</span> <span class="n">dumped</span><span class="p">)</span>
</pre></div>
</div>
<p>is a hint that you have <em>not</em> kept this data.</p>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="epics.ca.DEFAULT_SUBSCRIPTION_MASK">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_SUBSCRIPTION_MASK</span></span><a class="headerlink" href="#epics.ca.DEFAULT_SUBSCRIPTION_MASK" title="Link to this definition">¶</a></dt>
<dd><p>This value is the default subscription type used when calling
<a class="reference internal" href="#epics.ca.create_subscription" title="epics.ca.create_subscription"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_subscription()</span></code></a> with <cite>mask=None</cite>. It is also used by
default when creating a <code class="xref py py-class docutils literal notranslate"><span class="pre">PV</span></code> object with auto_monitor is set
to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>The initial default value is <em>dbr.DBE_ALARM|dbr.DBE_VALUE</em>
(i.e. update on alarm changes or value changes which exceeds the
monitor deadband.)  The other possible flag in the bitmask is
<em>dbr.DBE_LOG</em> for archive-deadband changes.</p>
<p>If this value is changed, it will change the default for all
subsequent calls to <a class="reference internal" href="#epics.ca.create_subscription" title="epics.ca.create_subscription"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_subscription()</span></code></a>, but it will not
change any existing subscriptions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.clear_subscription">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">clear_subscription</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.clear_subscription" title="Link to this definition">¶</a></dt>
<dd><p>cancel subscription given its <em>event_id</em></p>
</dd></dl>

<p>Several other functions are provided:</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.get_timestamp">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">get_timestamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.get_timestamp" title="Link to this definition">¶</a></dt>
<dd><p>return the timestamp of a Channel – the time of last update.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.get_severity">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">get_severity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.get_severity" title="Link to this definition">¶</a></dt>
<dd><p>return the severity of a Channel.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.get_precision">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">get_precision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.get_precision" title="Link to this definition">¶</a></dt>
<dd><p>return the precision of a Channel.  For Channels with
native type other than FLOAT or DOUBLE, this will be 0</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.get_enum_strings">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">get_enum_strings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.get_enum_strings" title="Link to this definition">¶</a></dt>
<dd><p>return list of names for ENUM states of a Channel.  Returns
None for non-ENUM Channels</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.get_ctrlvars">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">get_ctrlvars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.get_ctrlvars" title="Link to this definition">¶</a></dt>
<dd><p>return the CTRL fields for a Channel.</p>
<dl class="simple">
<dt>Depending on the native type, the keys may include</dt><dd><p><em>status</em>, <em>severity</em>, <em>precision</em>, <em>units</em>, enum_strs*,
<em>upper_disp_limit</em>, <em>lower_disp_limit</em>, upper_alarm_limit*,
<em>lower_alarm_limit</em>, upper_warning_limit*, <em>lower_warning_limit</em>,
<em>upper_ctrl_limit</em>, <em>lower_ctrl_limit</em></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>enum_strs will be a list of strings for the names of ENUM states.</p>
</dd></dl>

<p>See <a class="reference internal" href="#ctrlvars-table"><span class="std std-ref">Table of Control Attributes</span></a></p>
<blockquote id="ctrlvars-table">
<div><p>Table of Control Attributes</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><em>attribute</em></p></th>
<th class="head"><p><em>data types</em></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>status</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>severity</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>precision</p></td>
<td><p>0 for all but double, float</p></td>
</tr>
<tr class="row-odd"><td><p>units</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>enum_strs</p></td>
<td><p>enum only</p></td>
</tr>
<tr class="row-odd"><td><p>upper_disp_limit</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>lower_disp_limit</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>upper_alarm_limit</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>lower_alarm_limit</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>upper_warning_limit</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>lower_warning_limit</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>upper_ctrl_limit</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>lower_ctrl_limit</p></td>
<td></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>Note that <em>enum_strs</em> will be a tuple of strings for the names of ENUM
states.</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.get_timevars">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">get_timevars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.get_timevars" title="Link to this definition">¶</a></dt>
<dd><p>returns a dictionary of TIME fields for a Channel.
This will contain keys of  <em>status</em>, <em>severity</em>, and <em>timestamp</em>.</p>
</dd></dl>

</section>
<section id="synchronous-groups">
<span id="ca-sg-label"></span><h3>Synchronous Groups<a class="headerlink" href="#synchronous-groups" title="Link to this heading">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Synchronous groups are simulated in pyepics, but are not recommended,
and probably don’t really make sense for usage within pyepics and using
asynchronous i/o anyway.</p>
</div>
<p>Synchronous Groups are can be used to ensure that a set of Channel Access
calls all happen together, as if in a <em>transaction</em>.  Synchronous Groups
should be avoided in pyepics, and are not well tested.  They probably make
little sens in the context of asynchronous I/O.  The documentation here is
given for historical purposes.</p>
<p>The idea is to first create a synchronous group, then add a series of
<a class="reference internal" href="#epics.ca.sg_put" title="epics.ca.sg_put"><code class="xref py py-func docutils literal notranslate"><span class="pre">sg_put()</span></code></a> and <a class="reference internal" href="#epics.ca.sg_get" title="epics.ca.sg_get"><code class="xref py py-func docutils literal notranslate"><span class="pre">sg_get()</span></code></a> which do not happen immediately, and
finally block while all the channel access communication is done for the
group as a unit.  It is important to <em>not</em> issue <a class="reference internal" href="#epics.ca.pend_io" title="epics.ca.pend_io"><code class="xref py py-func docutils literal notranslate"><span class="pre">pend_io()</span></code></a> during the
building of a synchronous group, as this will cause pending <a class="reference internal" href="#epics.ca.sg_put" title="epics.ca.sg_put"><code class="xref py py-func docutils literal notranslate"><span class="pre">sg_put()</span></code></a>
and <a class="reference internal" href="#epics.ca.sg_get" title="epics.ca.sg_get"><code class="xref py py-func docutils literal notranslate"><span class="pre">sg_get()</span></code></a> to execute.</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.sg_create">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">sg_create</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.sg_create" title="Link to this definition">¶</a></dt>
<dd><p>create synchronous group.
Returns a <em>group id</em>, <cite>gid</cite>, which is used to identify this group and
to be passed to all other synchronous group commands.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.sg_delete">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">sg_delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.sg_delete" title="Link to this definition">¶</a></dt>
<dd><p>delete a synchronous group</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.sg_block">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">sg_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gid</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">timeout=10.0</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.sg_block" title="Link to this definition">¶</a></dt>
<dd><p>block for a synchronous group to complete processing</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.sg_get">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">sg_get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chid</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">ftype=None</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">as_string=False</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">as_numpy=True</span></span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.sg_get" title="Link to this definition">¶</a></dt>
<dd><p>synchronous-group get of the current value for a Channel.
same options as get()</p>
<p>This function will not immediately return the value, of course, but the
address of the underlying data.</p>
<p>After the <a class="reference internal" href="#epics.ca.sg_block" title="epics.ca.sg_block"><code class="xref py py-func docutils literal notranslate"><span class="pre">sg_block()</span></code></a> has completed, you must use <a class="reference internal" href="#epics.ca._unpack" title="epics.ca._unpack"><code class="xref py py-func docutils literal notranslate"><span class="pre">_unpack()</span></code></a>
to convert this data address to the actual value(s).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chid</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">ca</span><span class="o">.</span><span class="n">create_channel</span><span class="p">(</span><span class="n">PV_Name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epics</span><span class="o">.</span><span class="n">ca</span><span class="o">.</span><span class="n">connect_channel</span><span class="p">(</span><span class="n">chid1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">ca</span><span class="o">.</span><span class="n">sg_create</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">ca</span><span class="o">.</span><span class="n">sg_get</span><span class="p">(</span><span class="n">sg</span><span class="p">,</span> <span class="n">chid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epics</span><span class="o">.</span><span class="n">ca</span><span class="o">.</span><span class="n">sg_block</span><span class="p">(</span><span class="n">sg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">epics</span><span class="o">.</span><span class="n">ca</span><span class="o">.</span><span class="n">_unpack</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">chid</span><span class="o">=</span><span class="n">chid</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.sg_put">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">sg_put</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.sg_put" title="Link to this definition">¶</a></dt>
<dd><p>perform a <cite>put</cite> within a synchronous group.</p>
<p>This <cite>put</cite> cannot wait for completion or for a a callback to complete.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.sg_test">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">sg_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.sg_test" title="Link to this definition">¶</a></dt>
<dd><p>test whether a synchronous group has completed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.sg_reset">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">sg_reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.sg_reset" title="Link to this definition">¶</a></dt>
<dd><p>resets a synchronous group</p>
</dd></dl>

</section>
</section>
<section id="implementation-details">
<span id="ca-implementation-label"></span><h2>Implementation details<a class="headerlink" href="#implementation-details" title="Link to this heading">¶</a></h2>
<p>The details given here should mostly be of interest to those looking at the
implementation of the <cite>ca</cite> module, those interested in the internals, or
those looking to translate lower-level C or Python code to this module.</p>
<section id="dbr-data-types">
<h3>DBR data types<a class="headerlink" href="#dbr-data-types" title="Link to this heading">¶</a></h3>
<blockquote id="dbrtype-table">
<div><p>Table of DBR Types</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><em>CA type</em></p></th>
<th class="head"><p><em>integer ftype</em></p></th>
<th class="head"><p><em>Python ctypes type</em></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>0</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-odd"><td><p>int</p></td>
<td><p>1</p></td>
<td><p>integer</p></td>
</tr>
<tr class="row-even"><td><p>short</p></td>
<td><p>1</p></td>
<td><p>integer</p></td>
</tr>
<tr class="row-odd"><td><p>float</p></td>
<td><p>2</p></td>
<td><p>double</p></td>
</tr>
<tr class="row-even"><td><p>enum</p></td>
<td><p>3</p></td>
<td><p>integer</p></td>
</tr>
<tr class="row-odd"><td><p>char</p></td>
<td><p>4</p></td>
<td><p>byte</p></td>
</tr>
<tr class="row-even"><td><p>long</p></td>
<td><p>5</p></td>
<td><p>integer</p></td>
</tr>
<tr class="row-odd"><td><p>double</p></td>
<td><p>6</p></td>
<td><p>double</p></td>
</tr>
<tr class="row-even"><td><p>time_string</p></td>
<td><p>14</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>time_int</p></td>
<td><p>15</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>time_short</p></td>
<td><p>15</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>time_float</p></td>
<td><p>16</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>time_enum</p></td>
<td><p>17</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>time_char</p></td>
<td><p>18</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>time_long</p></td>
<td><p>19</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>time_double</p></td>
<td><p>20</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ctrl_string</p></td>
<td><p>28</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ctrl_int</p></td>
<td><p>29</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ctrl_short</p></td>
<td><p>29</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ctrl_float</p></td>
<td><p>30</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ctrl_enum</p></td>
<td><p>31</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ctrl_char</p></td>
<td><p>32</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ctrl_long</p></td>
<td><p>33</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ctrl_double</p></td>
<td><p>34</p></td>
<td></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
</section>
<section id="pysevchk-and-channelaccessexcepction-checking-ca-return-codes">
<h3><cite>PySEVCHK</cite> and ChannelAccessExcepction: checking CA return codes<a class="headerlink" href="#pysevchk-and-channelaccessexcepction-checking-ca-return-codes" title="Link to this heading">¶</a></h3>
<dl class="py exception">
<dt class="sig sig-object py" id="epics.ca.ChannelAccessException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">ChannelAccessException</span></span><a class="headerlink" href="#epics.ca.ChannelAccessException" title="Link to this definition">¶</a></dt>
<dd><p>This exception is raised when the <code class="xref py py-mod docutils literal notranslate"><span class="pre">ca</span></code> module experiences
unexpected behavior and must raise an exception</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.PySEVCHK">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">PySEVCHK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">expected=dbr.ECA_NORMAL</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.PySEVCHK" title="Link to this definition">¶</a></dt>
<dd><p>This checks the return <em>status</em> returned from a <cite>libca.ca_***</cite> and
raises a <a class="reference internal" href="#epics.ca.ChannelAccessException" title="epics.ca.ChannelAccessException"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ChannelAccessException</span></code></a> if the value does not match the
<em>expected</em> value (which is nornmally <code class="docutils literal notranslate"><span class="pre">dbr.ECA_NORMAL</span></code>.</p>
<p>The message from the exception will include the <em>func_name</em> (name of
the Python function) and the CA message from <a class="reference internal" href="#epics.ca.message" title="epics.ca.message"><code class="xref py py-func docutils literal notranslate"><span class="pre">message()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.withSEVCHK">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">withSEVCHK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.withSEVCHK" title="Link to this definition">¶</a></dt>
<dd><p>decorator to raise a ChannelAccessException if the wrapped
ca function does not return status = dbr.ECA_NORMAL.  This
handles the common case of running <a class="reference internal" href="#epics.ca.PySEVCHK" title="epics.ca.PySEVCHK"><code class="xref py py-func docutils literal notranslate"><span class="pre">PySEVCHK()</span></code></a> for a
function whose return value is from a corresponding libca function
and whose return value should be <code class="docutils literal notranslate"><span class="pre">dbr.ECA_NORMAL</span></code>.</p>
</dd></dl>

</section>
<section id="function-decorators">
<h3>Function Decorators<a class="headerlink" href="#function-decorators" title="Link to this heading">¶</a></h3>
<p>In addition to <a class="reference internal" href="#epics.ca.withSEVCHK" title="epics.ca.withSEVCHK"><code class="xref py py-func docutils literal notranslate"><span class="pre">withSEVCHK()</span></code></a>, several other decorator functions are
used heavily inside of ca.py or are available for your convenience.</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.withCA">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">withCA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.withCA" title="Link to this definition">¶</a></dt>
<dd><p>decorator to ensure that libca and a context are created
prior to function calls to the channel access library. This is
intended for functions that need CA started to work, such as
<a class="reference internal" href="#epics.ca.create_channel" title="epics.ca.create_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_channel()</span></code></a>.</p>
<p>Note that CA functions that take a Channel ID (chid) as an
argument are  NOT wrapped by this: to get a chid, the
library must have been initialized already.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.withCHID">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">withCHID</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.withCHID" title="Link to this definition">¶</a></dt>
<dd><p>decorator to ensure that first argument to a function is a Channel
ID, <code class="docutils literal notranslate"><span class="pre">chid</span></code>.  The test performed is very weak, as any ctypes long or
python int will pass, but it is useful enough to catch most accidental
errors before they would cause a crash of the CA library.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.withConnectedCHID">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">withConnectedCHID</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.withConnectedCHID" title="Link to this definition">¶</a></dt>
<dd><p>decorator to ensure that the first argument of a function is a
fully connected Channel ID, <code class="docutils literal notranslate"><span class="pre">chid</span></code>.  This test is (intended to be)
robust, and will try to make sure a <code class="docutils literal notranslate"><span class="pre">chid</span></code> is actually connected
before calling the decorated function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.withInitialContext">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">withInitialContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.withInitialContext" title="Link to this definition">¶</a></dt>
<dd><p>decorator to ensure that the wrapped function uses the
initial threading context created at initialization of CA</p>
</dd></dl>

<p>See <a class="reference internal" href="advanced.html#advanced-threads-label"><span class="std std-ref">Using Python Threads</span></a> for further discussion.</p>
</section>
<section id="unpacking-data-from-callbacks">
<h3>Unpacking Data from Callbacks<a class="headerlink" href="#unpacking-data-from-callbacks" title="Link to this heading">¶</a></h3>
<p>Throughout the implementation, there are several places where data returned
by the underlying CA library needs to be be converted to Python data.  This
is encapsulated in the <a class="reference internal" href="#epics.ca._unpack" title="epics.ca._unpack"><code class="xref py py-func docutils literal notranslate"><span class="pre">_unpack()</span></code></a> function.  In general, you will not
have to run this code, but there is one exception:  when using
<a class="reference internal" href="#epics.ca.sg_get" title="epics.ca.sg_get"><code class="xref py py-func docutils literal notranslate"><span class="pre">sg_get()</span></code></a>, the values returned will have to be unpacked with this
function.</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca._unpack">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">_unpack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">count=None</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">ftype=None</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">as_numpy=None</span></span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca._unpack" title="Link to this definition">¶</a></dt>
<dd><p>unpacks raw data for a Channel ID <cite>chid</cite> returned by libca functions
including <cite>ca_array_get_callback</cite> or subscription callback, and returns
the corresponding Python data</p>
<p>Normally, users are not expected to need to access this function, but
it will be necessary why using <a class="reference internal" href="#epics.ca.sg_get" title="epics.ca.sg_get"><code class="xref py py-func docutils literal notranslate"><span class="pre">sg_get()</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>chid</strong><span class="classifier">ctypes.c_long or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>channel ID (if not None, used for determining count and ftype)</p>
</dd>
<dt><strong>data</strong><span class="classifier">object</span></dt><dd><p>raw data as returned by internal libca functions.</p>
</dd>
<dt><strong>count</strong><span class="classifier">integer</span></dt><dd><p>number of elements to fetch (defaults to element count of chid  or 1)</p>
</dd>
<dt><strong>ftype</strong><span class="classifier">integer</span></dt><dd><p>data type of channel (defaults to native type of chid)</p>
</dd>
<dt><strong>as_numpy</strong><span class="classifier">bool</span></dt><dd><p>whether to convert to numpy array.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="user-supplied-callback-functions">
<span id="ca-callbacks-label"></span><h2>User-supplied Callback functions<a class="headerlink" href="#user-supplied-callback-functions" title="Link to this heading">¶</a></h2>
<p>User-supplied callback functions can be provided for <a class="reference internal" href="#epics.ca.put" title="epics.ca.put"><code class="xref py py-func docutils literal notranslate"><span class="pre">put()</span></code></a>,
<a class="reference internal" href="#epics.ca.replace_access_rights_event" title="epics.ca.replace_access_rights_event"><code class="xref py py-func docutils literal notranslate"><span class="pre">replace_access_rights_event()</span></code></a>, and <a class="reference internal" href="#epics.ca.create_subscription" title="epics.ca.create_subscription"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_subscription()</span></code></a>.
Note that callbacks for <cite>PV</cite> objects are slightly different: see
<a class="reference internal" href="pv.html#pv-callbacks-label"><span class="std std-ref">User-supplied Callback functions</span></a> in the <a class="reference internal" href="pv.html#module-pv" title="pv: PV objects for Epics Channel Access"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pv</span></code></a> module for details.</p>
<p>When defining a callback function to be run either when a <a class="reference internal" href="#epics.ca.put" title="epics.ca.put"><code class="xref py py-func docutils literal notranslate"><span class="pre">put()</span></code></a> completes
or on changes to the Channel, as set from <a class="reference internal" href="#epics.ca.create_subscription" title="epics.ca.create_subscription"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_subscription()</span></code></a>, or when
read/write permissions change from <a class="reference internal" href="#epics.ca.replace_access_rights_event" title="epics.ca.replace_access_rights_event"><code class="xref py py-func docutils literal notranslate"><span class="pre">replace_access_rights_event()</span></code></a>, it is
important to know two things:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>how your function will be called.</p></li>
<li><p>what is permissible to do inside your callback function.</p></li>
</ol>
</div></blockquote>
<p>Callbacks will be called with keyword arguments for <a class="reference internal" href="#epics.ca.put" title="epics.ca.put"><code class="xref py py-func docutils literal notranslate"><span class="pre">put()</span></code></a> and for
<a class="reference internal" href="#epics.ca.create_subscription" title="epics.ca.create_subscription"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_subscription()</span></code></a>.  You should be prepared to have them passed to
your function.  Use <cite>**kw</cite> unless you are very sure of what will be sent.
For the case of <a class="reference internal" href="#epics.ca.replace_access_rights_event" title="epics.ca.replace_access_rights_event"><code class="xref py py-func docutils literal notranslate"><span class="pre">replace_access_rights_event()</span></code></a>, only positional arguments
will be passed.</p>
<p>For callbacks sent when a <a class="reference internal" href="#epics.ca.put" title="epics.ca.put"><code class="xref py py-func docutils literal notranslate"><span class="pre">put()</span></code></a> completes, your function will be passed these:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>pvname</cite> : the name of the pv</p></li>
<li><p><cite>data</cite>:  the user-supplied callback_data (defaulting to <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
</ul>
</div></blockquote>
<p>For subscription callbacks, your function will be called with keyword/value
pairs that will include:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>pvname</cite>: the name of the pv</p></li>
<li><p><cite>value</cite>: the latest value</p></li>
<li><p><cite>count</cite>: the number of data elements</p></li>
<li><p><cite>ftype</cite>: the numerical CA type indicating the data type</p></li>
<li><p><cite>status</cite>: the status of the PV (0 for OK)</p></li>
<li><p><cite>chid</cite>:   the integer address for the channel ID.</p></li>
</ul>
</div></blockquote>
<p>For access rights event callbacks, your function will be passed:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>read_access</cite>: boolean indicating read access status</p></li>
<li><p><cite>write_access</cite>: boolean indicating write access status</p></li>
</ul>
</div></blockquote>
<p>Depending on the data type, and whether the CTRL or TIME variant was used,
the callback function may also include some of these as keyword arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>enum_strs</cite>: the list of enumeration strings</p></li>
<li><p><cite>precision</cite>: number of decimal places of precision.</p></li>
<li><p><cite>units</cite>:  string for PV units</p></li>
<li><p><cite>severity</cite>: PV severity</p></li>
<li><p><cite>timestamp</cite>: timestamp from CA server.</p></li>
<li><p><cite>posixseconds</cite>: integer seconds since POSIX epoch of timestamp from CA server.</p></li>
<li><p><cite>nanoseconds</cite>: integer nanoseconds of timestamp from CA server.</p></li>
</ul>
</div></blockquote>
<p>Note that a the user-supplied callback will be run <em>inside</em> a CA function,
and cannot reliably make any other CA calls.  It is helpful to think “this
all happens inside of a <a class="reference internal" href="#epics.ca.pend_event" title="epics.ca.pend_event"><code class="xref py py-func docutils literal notranslate"><span class="pre">pend_event()</span></code></a> call”, and in an epics thread
that may or may not be the main thread of your program.  It is advisable to
keep the callback functions short and not resource-intensive.  Consider
strategies which use the callback only to record that a change has occurred
and then act on that change later – perhaps in a separate thread, perhaps
after <a class="reference internal" href="#epics.ca.pend_event" title="epics.ca.pend_event"><code class="xref py py-func docutils literal notranslate"><span class="pre">pend_event()</span></code></a> has completed.</p>
</section>
<section id="omissions">
<span id="ca-omissions-label"></span><h2>Omissions<a class="headerlink" href="#omissions" title="Link to this heading">¶</a></h2>
<p>Several parts of the CA library are not implemented in the Python module.
These are currently seen as unneeded (with notes where appropriate for
alternatives), though they could be added on request.</p>
<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.ca_add_exception_event">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">ca_add_exception_event</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.ca_add_exception_event" title="Link to this definition">¶</a></dt>
<dd><p><em>Not implemented</em>: Python exceptions are raised where appropriate and
can be used in user code.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.ca_add_fd_registration">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">ca_add_fd_registration</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.ca_add_fd_registration" title="Link to this definition">¶</a></dt>
<dd><p><em>Not implemented</em></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.ca_client_status">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">ca_client_status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.ca_client_status" title="Link to this definition">¶</a></dt>
<dd><p><em>Not implemented</em></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.ca_set_puser">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">ca_set_puser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.ca_set_puser" title="Link to this definition">¶</a></dt>
<dd><p><em>Not implemented</em> : it is easy to pass user-defined data to callbacks as needed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.ca_puser">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">ca_puser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.ca_puser" title="Link to this definition">¶</a></dt>
<dd><p><em>Not implemented</em>: it is easy to pass user-defined data to callbacks as needed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.ca_SEVCHK">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">ca_SEVCHK</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.ca_SEVCHK" title="Link to this definition">¶</a></dt>
<dd><p><em>Not implemented</em>: the Python function <a class="reference internal" href="#epics.ca.PySEVCHK" title="epics.ca.PySEVCHK"><code class="xref py py-func docutils literal notranslate"><span class="pre">PySEVCHK()</span></code></a> is
approximately the same.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.ca_signal">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">ca_signal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.ca_signal" title="Link to this definition">¶</a></dt>
<dd><p><em>Not implemented</em>: the Python function <a class="reference internal" href="#epics.ca.PySEVCHK" title="epics.ca.PySEVCHK"><code class="xref py py-func docutils literal notranslate"><span class="pre">PySEVCHK()</span></code></a> is
approximately the same.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.ca_test_event">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">ca_test_event</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.ca_test_event" title="Link to this definition">¶</a></dt>
<dd><p><em>Not implemented</em>:  this appears to be a function for debugging events.
These are easy enough to simulate by directly calling Python callback
functions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="epics.ca.ca_dump_dbr">
<span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">ca_dump_dbr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.ca_dump_dbr" title="Link to this definition">¶</a></dt>
<dd><p><em>Not implemented</em></p>
</dd></dl>

<p>In addition, not all <cite>DBR</cite> types in the CA C library are supported.</p>
<p>Only native types and their DBR_TIME and DBR_CTRL variants are supported:
DBR_STS and DBR_GR variants are not. Several <cite>dbr_XXX</cite> functions are also
not supported, as they are needed only to dynamically allocate memory.</p>
</section>
<section id="cathread-class">
<h2><a class="reference internal" href="#epics.ca.CAThread" title="epics.ca.CAThread"><code class="xref py py-class docutils literal notranslate"><span class="pre">CAThread</span></code></a> class<a class="headerlink" href="#cathread-class" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="epics.ca.CAThread">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">epics.ca.</span></span><span class="sig-name descname"><span class="pre">CAThread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group=None</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">target=None</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">name=None</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">args=()</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">kwargs={}</span></span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#epics.ca.CAThread" title="Link to this definition">¶</a></dt>
<dd><p>create a CA-aware subclass of a standard Python <code class="xref py py-class docutils literal notranslate"><span class="pre">threading.Thread</span></code>.  See the
standard library documentation for further information on how to use Thread objects.</p>
<p>A <cite>CAThread</cite> simply runs <a class="reference internal" href="#epics.ca.use_initial_context" title="epics.ca.use_initial_context"><code class="xref py py-func docutils literal notranslate"><span class="pre">use_initial_context()</span></code></a> prior to running each target
function, so that <a class="reference internal" href="#epics.ca.use_initial_context" title="epics.ca.use_initial_context"><code class="xref py py-func docutils literal notranslate"><span class="pre">use_initial_context()</span></code></a> does not have to be explicitly put inside
the target function.</p>
<p>The See <a class="reference internal" href="advanced.html#advanced-threads-label"><span class="std std-ref">Using Python Threads</span></a> for further discussion.</p>
</dd></dl>

</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<p>Here are some example sessions using the <code class="xref py py-mod docutils literal notranslate"><span class="pre">ca</span></code> module.</p>
<section id="create-connect-get-value-of-channel">
<h3>Create, Connect, Get Value of Channel<a class="headerlink" href="#create-connect-get-value-of-channel" title="Link to this heading">¶</a></h3>
<p>Note here that several things have been simplified compare to using CA in C:
initialization and creating a main-thread context are handled, and connection
of channels is handled in the background:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">epics</span> <span class="kn">import</span> <span class="n">ca</span>
<span class="n">chid</span>  <span class="o">=</span> <span class="n">ca</span><span class="o">.</span><span class="n">create_channel</span><span class="p">(</span><span class="s1">&#39;XXX:m1.VAL&#39;</span><span class="p">)</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">ca</span><span class="o">.</span><span class="n">element_count</span><span class="p">(</span><span class="n">chid</span><span class="p">)</span>
<span class="n">ftype</span> <span class="o">=</span> <span class="n">ca</span><span class="o">.</span><span class="n">field_type</span><span class="p">(</span><span class="n">chid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Channel &quot;</span><span class="p">,</span> <span class="n">chid</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">ftype</span><span class="p">)</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">ca</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="put-waiting-for-completion">
<h3>Put, waiting for completion<a class="headerlink" href="#put-waiting-for-completion" title="Link to this heading">¶</a></h3>
<p>Here we set a PVs value, waiting for it to complete:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">epics</span> <span class="kn">import</span> <span class="n">ca</span>
<span class="n">chid</span>  <span class="o">=</span> <span class="n">ca</span><span class="o">.</span><span class="n">create_channel</span><span class="p">(</span><span class="s1">&#39;XXX:m1.VAL&#39;</span><span class="p">)</span>
<span class="n">ca</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">chid</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The  <a class="reference internal" href="#epics.ca.put" title="epics.ca.put"><code class="xref py py-func docutils literal notranslate"><span class="pre">put()</span></code></a> method will wait to return until the processing is
complete.</p>
</section>
<section id="define-a-callback-to-subscribe-to-changes">
<h3>Define a callback to Subscribe to Changes<a class="headerlink" href="#define-a-callback-to-subscribe-to-changes" title="Link to this heading">¶</a></h3>
<p>Here, we <em>subscribe to changes</em> for a PV, which is to say we define a
callback function to be called whenever the PV value changes.   In the case
below, the function to be called will simply write the latest value out to
standard output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">epics</span> <span class="kn">import</span> <span class="n">ca</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># define a callback function.  Note that this should</span>
<span class="c1"># expect certain keyword arguments, including &#39;pvname&#39; and &#39;value&#39;</span>
<span class="k">def</span> <span class="nf">onChanges</span><span class="p">(</span><span class="n">pvname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;New Value: </span><span class="si">%s</span><span class="s1">  value=</span><span class="si">%s</span><span class="s1">, kw=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fmt</span> <span class="o">%</span> <span class="p">(</span><span class="n">pvname</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">kw</span><span class="p">)))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="c1"># create the channel</span>
<span class="n">mypv</span> <span class="o">=</span> <span class="s1">&#39;XXX.VAL&#39;</span>
<span class="n">chid</span> <span class="o">=</span> <span class="n">ca</span><span class="o">.</span><span class="n">create_channel</span><span class="p">(</span><span class="n">mypv</span><span class="p">)</span>

<span class="c1"># subscribe to events giving a callback function</span>
<span class="n">eventID</span> <span class="o">=</span> <span class="n">ca</span><span class="o">.</span><span class="n">create_subscription</span><span class="p">(</span><span class="n">chid</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">onChanges</span><span class="p">)</span>

<span class="c1"># now we simply wait for changes</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span> <span class="o">&lt;</span> <span class="mf">10.0</span><span class="p">:</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>
</div>
<p>It is <strong>vital</strong> that the return value from <a class="reference internal" href="#epics.ca.create_subscription" title="epics.ca.create_subscription"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_subscription()</span></code></a> is
kept in a variable so that it cannot be garbage collected.  Failure to keep
this value will cause trouble, including almost immediate segmentation
faults (on Windows) or seemingly inexplicable crashes later (on linux).</p>
</section>
<section id="define-a-connection-callback">
<h3>Define a connection callback<a class="headerlink" href="#define-a-connection-callback" title="Link to this heading">¶</a></h3>
<p>Here, we define a connection callback – a function to be called when the
connection status of the PV changes. Note that this will be called on
initial connection:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">epics</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">onConnectionChange</span><span class="p">(</span><span class="n">pvname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ca connection status changed:  </span><span class="si">{</span><span class="n">pvname</span><span class="si">}</span><span class="s1">,  </span><span class="si">{</span><span class="n">conn</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">chid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># create channel, provide connection callback</span>
<span class="n">motor1</span> <span class="o">=</span> <span class="s1">&#39;13IDC:m1&#39;</span>
<span class="n">chid</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">ca</span><span class="o">.</span><span class="n">create_channel</span><span class="p">(</span><span class="n">motor1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">onConnectionChange</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Now waiting, watching values and connection changes:&#39;</span><span class="p">)</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>
</div>
<p>This will run the supplied callback soon after the channel has been
created, when a successful connection has been made.  Note that the
callback should be prepared to accept keyword arguments of <cite>pvname</cite>,
<cite>chid</cite>, and <cite>conn</cite> for the PV name, channel ID, and connection state
(<code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
</section>
<section id="define-an-access-rights-change-event-callback">
<h3>Define an access rights change event callback<a class="headerlink" href="#define-an-access-rights-change-event-callback" title="Link to this heading">¶</a></h3>
<p>The following example demonstrates the addition of a function to be
called when the access rights of a channel changes. Note this will be
called immediately after successful installation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">epics</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">on_access_rights_change</span><span class="p">(</span><span class="n">read_access</span><span class="p">,</span> <span class="n">write_access</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;read access=</span><span class="si">{</span><span class="n">read_access</span><span class="si">}</span><span class="s1">, write access=</span><span class="si">{</span><span class="n">write_access</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># create a channel and attach the above function for access rights events</span>
<span class="n">chid</span> <span class="o">=</span> <span class="n">epics</span><span class="o">.</span><span class="n">ca</span><span class="o">.</span><span class="n">create_channel</span><span class="p">(</span><span class="s1">&#39;pv_name&#39;</span><span class="p">)</span>
<span class="c1"># a message should be printed immediately following this registration</span>
<span class="n">epics</span><span class="o">.</span><span class="n">ca</span><span class="o">.</span><span class="n">replace_access_rights_event</span><span class="p">(</span><span class="n">chid</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">on_access_rights_change</span><span class="p">)</span>

<span class="c1"># Affecting the channel&#39;s access rights, (for example, by enabling/disabling</span>
<span class="c1"># CA Security rules), should produce additional console messages</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="arrays.html" title="Working with waveform / array data"
             >next</a> |</li>
        <li class="right" >
          <a href="pv.html" title="PV: Epics Process Variables"
             >previous</a> |</li>
   <li>[<a href="installation.html">install</a></li>
   <li>|<a href="overview.html">overview</a></li>
   <li>|<a href="pv.html">pv</a></li>
   <li>|<a href="#">ca</a></li>
   <li>|<a href="arrays.html">arrays</a></li>
   <li>|<a href="devices.html">devices</a></li>
   <li>|<a href="alarm.html">alarm</a></li>
   <li>|<a href="autosave.html">autosave</a></li>
   <li>|<a href="wx.html">wx</a></li>
   <li>|<a href="advanced.html">advanced</a>]</li>

        <li class="nav-item nav-item-this"><a href="">ca: Low-level Channel Access module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2021, Matthew Newville.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>
  </body>
</html>